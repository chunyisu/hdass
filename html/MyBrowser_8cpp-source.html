<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>HDASS: MyBrowser.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>MyBrowser.cpp</h1><a href="MyBrowser_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/***************************************************************************</span>
00002 <span class="comment"> *   Copyright (C) 2004 by Karban                                          *</span>
00003 <span class="comment"> *   Karban@scream01.csie.ncku.edu.tw                                      *</span>
00004 <span class="comment"> *                                                                         *</span>
00005 <span class="comment"> *   This program is free software; you can redistribute it and/or modify  *</span>
00006 <span class="comment"> *   it under the terms of the GNU General Public License as published by  *</span>
00007 <span class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</span>
00008 <span class="comment"> *   (at your option) any later version.                                   *</span>
00009 <span class="comment"> *                                                                         *</span>
00010 <span class="comment"> *   This program is distributed in the hope that it will be useful,       *</span>
00011 <span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *</span>
00012 <span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *</span>
00013 <span class="comment"> *   GNU General Public License for more details.                          *</span>
00014 <span class="comment"> *                                                                         *</span>
00015 <span class="comment"> *   You should have received a copy of the GNU General Public License     *</span>
00016 <span class="comment"> *   along with this program; if not, write to the                         *</span>
00017 <span class="comment"> *   Free Software Foundation, Inc.,                                       *</span>
00018 <span class="comment"> *   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.             *</span>
00019 <span class="comment"> ***************************************************************************/</span>
00020 <span class="preprocessor">#include "<a class="code" href="MyBrowser_8h.html">MyBrowser.h</a>"</span>
00021 
00022 <span class="preprocessor">#include &lt;qstring.h&gt;</span>
00023 
00024 <span class="preprocessor">#include &lt;kparts/browserextension.h&gt;</span> 
00025 <span class="preprocessor">#include &lt;kurl.h&gt;</span>
00026 <span class="preprocessor">#include &lt;kdebug.h&gt;</span>
00027 <span class="preprocessor">#include "<a class="code" href="global__define_8h.html">global_define.h</a>"</span>
<a name="l00028"></a><a class="code" href="classMyBrowser.html#MyBrowsera0">00028</a> <a class="code" href="classMyBrowser.html#MyBrowsera0">MyBrowser::MyBrowser</a>(<a class="code" href="classQWidget.html">QWidget</a> *parentWidget)
00029 : KHTMLPart(parentWidget)
00030 {
00031     <a class="code" href="classMyBrowser.html#MyBrowsero1">it_history</a> = <a class="code" href="classMyBrowser.html#MyBrowsero0">history</a>.begin();
00032     <a class="code" href="classMyBrowser.html#MyBrowsero3">home</a> = KURL(<span class="stringliteral">"http://tw.yahoo.com"</span>);
00033 <span class="preprocessor">    #if TRACE </span>
00034 <span class="preprocessor"></span>    kdDebug() &lt;&lt; <span class="stringliteral">"init() -&gt; "</span>&lt;&lt; <a class="code" href="classMyBrowser.html#MyBrowsero3">home</a> &lt;&lt; endl;    
00035 <span class="preprocessor">    #endif</span>
00036 <span class="preprocessor"></span>    <a class="code" href="classMyBrowser.html#MyBrowseri0">handleHome</a>();      
00037 }
00038 
00039 
<a name="l00040"></a><a class="code" href="classMyBrowser.html#MyBrowsera1">00040</a> <a class="code" href="classMyBrowser.html#MyBrowsera1">MyBrowser::~MyBrowser</a>()
00041 {
00042 
00043 }
00044 
<a name="l00045"></a><a class="code" href="classMyBrowser.html#MyBrowsera2">00045</a> <span class="keywordtype">void</span> <a class="code" href="classMyBrowser.html#MyBrowsera2">MyBrowser::urlSelected</a>(<span class="keyword">const</span> QString &amp;url, <span class="keywordtype">int</span> button, <span class="keywordtype">int</span> state, <span class="keyword">const</span> QString &amp;_target, KParts::URLArgs args)
00046 {
00047      KURL cURL = completeURL(url);
00048 <span class="preprocessor">     #if TRACE </span>
00049 <span class="preprocessor"></span>kdDebug() &lt;&lt; <span class="stringliteral">"urlSelect -&gt; "</span> &lt;&lt; cURL &lt;&lt; endl;     
00050 <span class="preprocessor">#endif</span>
00051 <span class="preprocessor"></span>     <span class="keywordflow">if</span>(cURL.protocol()==<span class="stringliteral">"http"</span>)
00052      {
00053         <a class="code" href="classMyBrowser.html#MyBrowsera4">removeHistory</a>();
00054         openURL(cURL);
00055         <a class="code" href="classMyBrowser.html#MyBrowsera3">saveHistory</a>(cURL);
00056      }
00057      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(cURL.protocol()==<span class="stringliteral">"hdas"</span>)
00058      {
00059 <span class="preprocessor">#if TRACE      </span>
00060 <span class="preprocessor"></span>kdDebug()&lt;&lt; <span class="stringliteral">"MyBrowser::urlSelected -&gt; HDAS -&gt; "</span> &lt;&lt; cURL &lt;&lt; endl;
00061 <span class="preprocessor">#endif</span>
00062 <span class="preprocessor"></span>        <a class="code" href="classMyBrowser.html#MyBrowsera5">getFile</a>(cURL);
00063      }
00064 }
00065 
<a name="l00066"></a><a class="code" href="classMyBrowser.html#MyBrowsera3">00066</a> <span class="keywordtype">void</span> <a class="code" href="classMyBrowser.html#MyBrowsera3">MyBrowser::saveHistory</a>(<span class="keyword">const</span> KURL &amp;url)
00067 {
00068 <span class="preprocessor">#if TRACE </span>
00069 <span class="preprocessor"></span>kdDebug() &lt;&lt; <span class="stringliteral">"Saving History !!"</span>&lt;&lt; endl;
00070 <span class="preprocessor">#endif</span>
00071 <span class="preprocessor"></span>        <a class="code" href="classMyBrowser.html#MyBrowsero0">history</a> &lt;&lt; url;      
00072         ++<a class="code" href="classMyBrowser.html#MyBrowsero1">it_history</a>;
00073 }
00074 
<a name="l00075"></a><a class="code" href="classMyBrowser.html#MyBrowsera4">00075</a> <span class="keywordtype">void</span> <a class="code" href="classMyBrowser.html#MyBrowsera4">MyBrowser::removeHistory</a>()
00076 {
00077     <span class="keywordflow">if</span>(<a class="code" href="classMyBrowser.html#MyBrowsero1">it_history</a> != <a class="code" href="classMyBrowser.html#MyBrowsero0">history</a>.end())
00078     {
00079         KURL::List::Iterator it_remove = <a class="code" href="classMyBrowser.html#MyBrowsero0">history</a>.end();
00080         <span class="keywordflow">for</span>(it_remove;it_remove!=<a class="code" href="classMyBrowser.html#MyBrowsero1">it_history</a>;it_remove--)<a class="code" href="classMyBrowser.html#MyBrowsero0">history</a>.remove((*it_remove).url());
00081     }
00082 }
00083 
<a name="l00084"></a><a class="code" href="classMyBrowser.html#MyBrowsera5">00084</a> <span class="keywordtype">void</span> <a class="code" href="classMyBrowser.html#MyBrowsera5">MyBrowser::getFile</a>(KURL &amp;url)
00085 {
00086 <span class="preprocessor">#if TRACE </span>
00087 <span class="preprocessor"></span>kdDebug()&lt;&lt; <span class="stringliteral">"getFile -&gt; download a mp3 file "</span>&lt;&lt; endl;
00088 <span class="preprocessor">#endif</span>
00089 <span class="preprocessor"></span>    <a class="code" href="classMyBrowser.html#MyBrowsero2">getfile</a> = <span class="keyword">new</span> <a class="code" href="classDownFile.html">DownFile</a>(url);
00090     connect(<a class="code" href="classMyBrowser.html#MyBrowsero2">getfile</a>,SIGNAL(Finished(<span class="keywordtype">bool</span>)),<span class="keyword">this</span>,SLOT(<a class="code" href="classMyBrowser.html#MyBrowseri5">handleCloseconnect</a>(<span class="keywordtype">bool</span>)));
00091 }
00092 
00093 <span class="comment">//========SLOT==( Handle Serial )===================================</span>
00094 
<a name="l00095"></a><a class="code" href="classMyBrowser.html#MyBrowseri0">00095</a> <span class="keywordtype">void</span> <a class="code" href="classMyBrowser.html#MyBrowseri0">MyBrowser::handleHome</a>()
00096 {
00097     <span class="keywordflow">if</span>(<a class="code" href="classMyBrowser.html#MyBrowsero3">home</a>.protocol()==<span class="stringliteral">"http"</span>)
00098     {
00099         openURL(<a class="code" href="classMyBrowser.html#MyBrowsero3">home</a>);
00100         <a class="code" href="classMyBrowser.html#MyBrowsera3">saveHistory</a>(<a class="code" href="classMyBrowser.html#MyBrowsero3">home</a>);
00101     }   
00102     <span class="keywordflow">else</span> kdDebug() &lt;&lt; <span class="stringliteral">"=====================Home -&gt; "</span> &lt;&lt; <a class="code" href="classMyBrowser.html#MyBrowsero3">home</a>.protocol() &lt;&lt; endl;
00103 }
00104 
<a name="l00105"></a><a class="code" href="classMyBrowser.html#MyBrowseri2">00105</a> <span class="keywordtype">void</span> <a class="code" href="classMyBrowser.html#MyBrowseri2">MyBrowser::handleNext</a>()
00106 {
00107 <span class="preprocessor">#if TRACE </span>
00108 <span class="preprocessor"></span>kdDebug() &lt;&lt; <span class="stringliteral">"handleNext"</span>&lt;&lt; endl;
00109 <span class="preprocessor">#endif</span>
00110 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(<a class="code" href="classMyBrowser.html#MyBrowsero1">it_history</a> != <a class="code" href="classMyBrowser.html#MyBrowsero0">history</a>.end())
00111     {
00112         ++<a class="code" href="classMyBrowser.html#MyBrowsero1">it_history</a>;
00113         openURL((*it_history).url());
00114 
00115     }   
00116 }
00117 
<a name="l00118"></a><a class="code" href="classMyBrowser.html#MyBrowseri3">00118</a> <span class="keywordtype">void</span> <a class="code" href="classMyBrowser.html#MyBrowseri3">MyBrowser::handlePrevious</a>()
00119 {
00120 <span class="preprocessor">#if TRACE </span>
00121 <span class="preprocessor"></span>kdDebug() &lt;&lt; <span class="stringliteral">"handlePrevious"</span>&lt;&lt; endl;
00122 <span class="preprocessor">#endif</span>
00123 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(<a class="code" href="classMyBrowser.html#MyBrowsero1">it_history</a> != <a class="code" href="classMyBrowser.html#MyBrowsero0">history</a>.begin())
00124     {
00125         --<a class="code" href="classMyBrowser.html#MyBrowsero1">it_history</a>;
00126         openURL((*it_history).url());
00127 
00128     }   
00129 }
00130 
<a name="l00131"></a><a class="code" href="classMyBrowser.html#MyBrowseri1">00131</a> <span class="keywordtype">void</span> <a class="code" href="classMyBrowser.html#MyBrowseri1">MyBrowser::handleRefresh</a>()
00132 {
00133 <span class="preprocessor">#if TRACE </span>
00134 <span class="preprocessor"></span>kdDebug() &lt;&lt; <span class="stringliteral">"handleRefresh"</span>&lt;&lt; endl;
00135 <span class="preprocessor">#endif    </span>
00136 <span class="preprocessor"></span>    openURL((*it_history).url());
00137 }
00138 
<a name="l00139"></a><a class="code" href="classMyBrowser.html#MyBrowseri4">00139</a> <span class="keywordtype">void</span> <a class="code" href="classMyBrowser.html#MyBrowseri4">MyBrowser::handleURL</a>(<span class="keyword">const</span> KURL &amp;uurl,<span class="keyword">const</span> KParts::URLArgs &amp;args)
00140 {
00141 <span class="preprocessor">#if TRACE </span>
00142 <span class="preprocessor"></span>kdDebug() &lt;&lt; <span class="stringliteral">"handleURL -&gt; submit control"</span>&lt;&lt; endl;
00143 <span class="preprocessor">#endif</span>
00144 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(uurl.protocol()==<span class="stringliteral">"http"</span>)
00145     {
00146         <a class="code" href="classMyBrowser.html#MyBrowsera4">removeHistory</a>();
00147         openURL(uurl);
00148         <a class="code" href="classMyBrowser.html#MyBrowsera3">saveHistory</a>(uurl);
00149     }   
00150     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(uurl.protocol()==<span class="stringliteral">"hdas"</span>)
00151     {           
00152         KURL url = uurl;
00153         <a class="code" href="classMyBrowser.html#MyBrowsera5">getFile</a>(url);
00154     }
00155 }
00156 
<a name="l00157"></a><a class="code" href="classMyBrowser.html#MyBrowseri5">00157</a> <span class="keywordtype">void</span> <a class="code" href="classMyBrowser.html#MyBrowseri5">MyBrowser::handleCloseconnect</a>(<span class="keywordtype">bool</span> error)
00158 {
00159     <span class="keyword">delete</span> <a class="code" href="classMyBrowser.html#MyBrowsero2">getfile</a>;
00160 <span class="preprocessor">    #if TRACE     </span>
00161 <span class="preprocessor"></span>kdDebug() &lt;&lt; <span class="stringliteral">"MyBrowser::handleCloseconnect -&gt; Delete connection !!!!"</span>&lt;&lt; endl;
00162 <span class="preprocessor">#endif    </span>
00163 <span class="preprocessor"></span>}
00164 <span class="preprocessor">#include "<a class="code" href="MyBrowser_8moc.html">MyBrowser.moc</a>"</span>
00165 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri May 13 16:53:36 2005 for HDASS by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
