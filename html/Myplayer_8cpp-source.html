<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>HDASS: Myplayer.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>Myplayer.cpp</h1><a href="Myplayer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/***************************************************************************</span>
00002 <span class="comment">                        Myplayer.h  -  description</span>
00003 <span class="comment">                            -------------------</span>
00004 <span class="comment">    begin                : 7-19 2004</span>
00005 <span class="comment">    copyright            : (C) 2004 by Karban</span>
00006 <span class="comment">    email                :</span>
00007 <span class="comment">***************************************************************************/</span>
00008 
00009 <span class="comment">/***************************************************************************</span>
00010 <span class="comment">*                                                                         *</span>
00011 <span class="comment">*   This program is free software; you can redistribute it and/or modify  *</span>
00012 <span class="comment">*   it under the terms of the GNU General Public License as published by  *</span>
00013 <span class="comment">*   the Free Software Foundation; either version 2 of the License, or     *</span>
00014 <span class="comment">*   (at your option) any later version.                                   *</span>
00015 <span class="comment">*                                                                         *</span>
00016 <span class="comment">***************************************************************************/</span>
00017  
00018 <span class="preprocessor">#include "<a class="code" href="Myplayer_8h.html">Myplayer.h</a>"</span>
00019 <span class="preprocessor">#include "<a class="code" href="enginecontroller_8h.html">enginecontroller.h</a>"</span>
00020 <span class="preprocessor">#include "<a class="code" href="amarokconfig_8h.html">amarokconfig.h</a>"</span>
00021 <span class="preprocessor">#include "<a class="code" href="artsengine_8h.html">artsengine.h</a>"</span>
00022 <span class="preprocessor">#include "<a class="code" href="metabundle_8h.html">metabundle.h</a>"</span>
00023 
00024 <span class="preprocessor">#include &lt;kdebug.h&gt;</span>
00025 <span class="preprocessor">#include &lt;kurl.h&gt;</span>
00026 <span class="preprocessor">#include &lt;kapplication.h&gt;</span>
00027 
00028 <span class="preprocessor">#include &lt;qstring.h&gt;</span>
00029 <span class="preprocessor">#include &lt;qfile.h&gt;</span>
00030 
<a name="l00031"></a><a class="code" href="classMyplayer.html#Myplayera0">00031</a> <a class="code" href="classMyplayer.html#Myplayera0">Myplayer::Myplayer</a>()
00032 {
00033      <span class="keywordtype">bool</span> restartArts = <span class="keyword">false</span>;
00034      <a class="code" href="classMyplayer.html#Myplayerr3">m_repeat</a> = <span class="keyword">true</span>;
00035      <a class="code" href="classMyplayer.html#Myplayerr4">m_random</a> = <span class="keyword">false</span>;
00036      <a class="code" href="classEngineBase.html">EngineBase</a>* <span class="keyword">const</span> engine = <span class="keyword">new</span> <a class="code" href="classArtsEngine.html">ArtsEngine</a>();
00037      engine-&gt;<a class="code" href="classEngineBase.html#EngineBasea2">init</a>( restartArts, 9, <span class="keyword">true</span> );<span class="comment">//AmarokConfig::rememberEffects() );</span>
00038      engine-&gt;<a class="code" href="classEngineBase.html#EngineBasea3">initMixer</a>( <span class="keyword">false</span> );<span class="comment">//AmarokConfig::hardwareMixer() ); try to check the hardware mixer and use it </span>
00039      engine-&gt;<a class="code" href="classEngineBase.html#EngineBasei4">setVolume</a>( 50 );
00040      <a class="code" href="classMyplayer.html#Myplayerr2">m_Vol</a> = 50;
00041      <a class="code" href="classEngineController.html#EngineControllere2">EngineController::setEngine</a>( engine );
00042      engine-&gt;<a class="code" href="classEngineBase.html#EngineBasea25">setSoundOutput</a>( <span class="stringliteral">"Alsa"</span> );
00043      engine-&gt;<a class="code" href="classEngineBase.html#EngineBasea26">setSoundDevice</a>( AmarokConfig::soundDevice() );
00044      engine-&gt;<a class="code" href="classEngineBase.html#EngineBasea27">setDefaultSoundDevice</a>( !AmarokConfig::customSoundDevice() );
00045      engine-&gt;<a class="code" href="classEngineBase.html#EngineBasea15">setRestoreEffects</a>( AmarokConfig::rememberEffects() );
00046          <span class="comment">//TODO deprecate/improve</span>
00047      engine-&gt;<a class="code" href="classEngineBase.html#EngineBasea24">setXfadeLength</a>( 2200 );
00048      <a class="code" href="classEngineController.html">EngineController</a>* <span class="keyword">const</span> ec = <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>();
00049      connect( ec, SIGNAL( orderNext() ), SLOT( <a class="code" href="classMyplayer.html#Myplayeri9">handleNext</a>() ) );
00050      connect( ec, SIGNAL( orderPrevious() ), SLOT( <a class="code" href="classMyplayer.html#Myplayeri10">handlePrevious</a>() ) );      
00051      connect(ec, SIGNAL(TrackPosition(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classMyplayer.html#Myplayeri11">handlePosition</a>(<span class="keywordtype">int</span>)) );
00052      it = <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.begin();
00053 }
00054 
<a name="l00055"></a><a class="code" href="classMyplayer.html#Myplayera1">00055</a> <a class="code" href="classMyplayer.html#Myplayera1">Myplayer::~Myplayer</a>()       
00056 {
00057    kdDebug() &lt;&lt; k_funcinfo &lt;&lt; endl;
00058 }
00059 
00060 <span class="comment">//==================Basic=Slot==================</span>
<a name="l00061"></a><a class="code" href="classMyplayer.html#Myplayeri0">00061</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri0">Myplayer::play</a>()
00062 {          
00063      <span class="keywordflow">if</span>(!<a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.isEmpty())
00064      {
00065        <a class="code" href="classMetaBundle.html">MetaBundle</a> bundle( (*it).url() );        
00066        <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri2">play</a>(bundle); 
00067        <a class="code" href="classMyplayer.html#Myplayera2">handleMessage</a>(bundle);
00068        kdDebug() &lt;&lt; <span class="stringliteral">"[engine] play: "</span> &lt;&lt; endl;            
00069      }
00070      <span class="keywordflow">else</span>
00071      {
00072         <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri5">stop</a>();
00073         kdDebug() &lt;&lt; <span class="stringliteral">"[engine] Stop: "</span> &lt;&lt; endl;            
00074      }
00075 }
<a name="l00076"></a><a class="code" href="classMyplayer.html#Myplayeri1">00076</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri0">Myplayer::play</a>(QString filename)
00077 {
00078    <span class="keywordtype">bool</span> find=<span class="keyword">false</span>;
00079    <span class="comment">//DAVID Find file with filename</span>
00080    <span class="keywordflow">for</span>( KURL::List::ConstIterator find_it = <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.begin();find_it != <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.end();find_it++)
00081    {
00082       <span class="keywordflow">if</span>((*find_it).fileName()==filename)
00083       {
00084         <span class="comment">//DAVID Find it</span>
00085         find=<span class="keyword">true</span>;
00086         it=<a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.find(*find_it);
00087       }
00088    }
00089    <span class="keywordflow">if</span>(find)
00090    {
00091        <a class="code" href="classMetaBundle.html">MetaBundle</a> bundle( (*it).url() );        
00092        <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri2">play</a>(<span class="keyword">true</span>,bundle); 
00093        <a class="code" href="classMyplayer.html#Myplayera2">handleMessage</a>(bundle);
00094        kdDebug() &lt;&lt; <span class="stringliteral">"[engine] play: "</span> &lt;&lt; endl;            
00095    }
00096    <span class="keywordflow">else</span> qWarning(<span class="stringliteral">"File Not Find!!"</span>);<span class="comment">//this situation should not be happend</span>
00097 
00098 }
<a name="l00099"></a><a class="code" href="classMyplayer.html#Myplayeri3">00099</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri3">Myplayer::stop</a>()
00100 {     
00101      <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri5">stop</a>();
00102      <a class="code" href="classMyplayer.html#Myplayeri11">handlePosition</a>(0);
00103      kdDebug() &lt;&lt; <span class="stringliteral">"[engine] Stop: "</span> &lt;&lt; endl;
00104 }
00105 
<a name="l00106"></a><a class="code" href="classMyplayer.html#Myplayeri2">00106</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri2">Myplayer::pause</a>()
00107 {
00108      <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri4">pause</a>();
00109      kdDebug() &lt;&lt; <span class="stringliteral">"[engine] Pause: "</span> &lt;&lt; endl;
00110 }
00111 
<a name="l00112"></a><a class="code" href="classMyplayer.html#Myplayeri6">00112</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri6">Myplayer::increase_volume</a>()
00113 {
00114      <a class="code" href="classMyplayer.html#Myplayeri8">setVolume</a>(<a class="code" href="classMyplayer.html#Myplayerr2">m_Vol</a>+5);        
00115      kdDebug() &lt;&lt; <span class="stringliteral">"[Myplayer]increase_Vol ++: "</span> &lt;&lt; endl;
00116 }
00117 
<a name="l00118"></a><a class="code" href="classMyplayer.html#Myplayeri7">00118</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri7">Myplayer::decrease_volume</a>()
00119 {
00120      <a class="code" href="classMyplayer.html#Myplayeri8">setVolume</a>(<a class="code" href="classMyplayer.html#Myplayerr2">m_Vol</a>-5);
00121      kdDebug() &lt;&lt; <span class="stringliteral">"[Myplayer]decrease_Vol --: "</span> &lt;&lt; endl;
00122 }
00123 
<a name="l00124"></a><a class="code" href="classMyplayer.html#Myplayeri8">00124</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri8">Myplayer::setVolume</a>(<span class="keywordtype">int</span> percent)
00125 {
00126      <span class="keywordflow">if</span>( percent &lt; 0 ) <a class="code" href="classMyplayer.html#Myplayerr2">m_Vol</a> = 0;
00127      <span class="keywordflow">else</span> <span class="keywordflow">if</span>( percent &gt; 100) <a class="code" href="classMyplayer.html#Myplayerr2">m_Vol</a> = 100;
00128      <span class="keywordflow">else</span> <a class="code" href="classMyplayer.html#Myplayerr2">m_Vol</a> = percent;
00129      <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri9">setVolume</a>(<a class="code" href="classMyplayer.html#Myplayerr2">m_Vol</a>);
00130      emit <a class="code" href="classMyplayer.html#Myplayerl1">volumeMessage</a>(<a class="code" href="classMyplayer.html#Myplayerr2">m_Vol</a>);
00131      kdDebug() &lt;&lt; <span class="stringliteral">"[Myplayer]setVolume: "</span> &lt;&lt; <a class="code" href="classMyplayer.html#Myplayerr2">m_Vol</a> &lt;&lt; endl;
00132 }
00133 
<a name="l00134"></a><a class="code" href="classMyplayer.html#Myplayeri4">00134</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri4">Myplayer::next</a>()
00135 {
00136      <span class="keywordflow">if</span>(!<a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.isEmpty())<span class="comment">//DAVID Check list empty</span>
00137      {
00138        <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri1">next</a>();
00139        kdDebug() &lt;&lt; <span class="stringliteral">"[engine] Next: "</span> &lt;&lt; endl;
00140      }
00141      <span class="keywordflow">else</span> 
00142      {
00143      
00144        <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri5">stop</a>();
00145      }
00146 }
00147 
<a name="l00148"></a><a class="code" href="classMyplayer.html#Myplayeri5">00148</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri5">Myplayer::previous</a>()
00149 {
00150      <span class="keywordflow">if</span>(!<a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.isEmpty())
00151      {
00152        <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri0">previous</a>();
00153        kdDebug() &lt;&lt; <span class="stringliteral">"[engine] Previous: "</span>&lt;&lt; endl;
00154      }
00155      <span class="keywordflow">else</span> <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri5">stop</a>();
00156      
00157 }
00158 
00159 <span class="comment">//=====================Handle=Slot=================================</span>
<a name="l00160"></a><a class="code" href="classMyplayer.html#Myplayeri9">00160</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri9">Myplayer::handleNext</a>()
00161 {
00162      kdDebug() &lt;&lt; <span class="stringliteral">"[engine] hanleNext: "</span> &lt;&lt; endl;
00163      <span class="keywordflow">if</span>(<a class="code" href="classMyplayer.html#Myplayerr4">m_random</a>)
00164      {
00165       qWarning(<span class="stringliteral">"Myplayer::random play item"</span>);
00166        it = <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.begin();
00167        <span class="keywordtype">int</span> randomNum = KApplication::random() % <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.count();
00168        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0;it != <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.end(); it++)
00169        {
00170          <span class="keywordflow">if</span>(i == randomNum)<span class="keywordflow">break</span>;
00171          <span class="keywordflow">else</span> i++;
00172        }
00173      }
00174      <span class="keywordflow">else</span> ++it;
00175    
00176      <span class="keywordflow">if</span>(it != <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.end())
00177      {
00178           <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri5">stop</a>();
00179           <span class="comment">//kdDebug() &lt;&lt; "[engine] play: " &lt;&lt; (*it).url();</span>
00180           <a class="code" href="classMetaBundle.html">MetaBundle</a> bundle( (*it).url() );  
00181           <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri2">play</a>(<span class="keyword">true</span>,bundle);     
00182           <a class="code" href="classMyplayer.html#Myplayera2">handleMessage</a>(bundle);
00183      }
00184      <span class="keywordflow">else</span>
00185      {
00186         
00187         <span class="keywordflow">if</span>(<a class="code" href="classMyplayer.html#Myplayerr3">m_repeat</a>)
00188         {
00189            it = <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.begin();
00190            qWarning(<span class="stringliteral">"Myplayer::repeat play item"</span>);
00191            <a class="code" href="classMetaBundle.html">MetaBundle</a> bundle( (*it).url());
00192            <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri2">play</a>(<span class="keyword">true</span>,bundle);
00193            <a class="code" href="classMyplayer.html#Myplayera2">handleMessage</a>(bundle);
00194         }
00195         
00196         <span class="keywordflow">else</span> 
00197         {      
00198              <span class="comment">//  qWarning("=======================");</span>
00199              <span class="comment">//  EngineController::instance()-&gt;stop();  </span>
00200            
00201         }
00202      }
00203 }
00204 
<a name="l00205"></a><a class="code" href="classMyplayer.html#Myplayeri10">00205</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri10">Myplayer::handlePrevious</a>()
00206 {
00207 <span class="comment">//     EngineBase *engine = EngineController::engine();</span>
00208      kdDebug() &lt;&lt; <span class="stringliteral">"[engine] hanlePrevious: "</span> &lt;&lt; endl;
00209      <span class="keywordflow">if</span>(it != <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.begin())
00210      {
00211         --it;
00212         <a class="code" href="classMetaBundle.html">MetaBundle</a> bundle( (*it).url() );  
00213 <span class="comment">//      if(engine-&gt;state() == EngineBase::Playing)</span>
00214           <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri2">play</a>(<span class="keyword">true</span>,bundle); 
00215         <a class="code" href="classMyplayer.html#Myplayera2">handleMessage</a>(bundle);    
00216      }
00217      <span class="keywordflow">else</span>
00218      {
00219         it = <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.end();
00220         --it;
00221         <a class="code" href="classMetaBundle.html">MetaBundle</a> bundle( (*it).url());
00222 <span class="comment">//      if(engine-&gt;state() == EngineBase::Playing)</span>
00223           <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri2">play</a>(<span class="keyword">true</span>,bundle);
00224         <a class="code" href="classMyplayer.html#Myplayera2">handleMessage</a>(bundle);
00225      }
00226 }
00227 
<a name="l00228"></a><a class="code" href="classMyplayer.html#Myplayeri12">00228</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri12">Myplayer::handleRepeat</a>(<span class="keywordtype">bool</span> repeat)
00229 {
00230      <a class="code" href="classMyplayer.html#Myplayerr3">m_repeat</a> = repeat;      
00231 }
00232 
<a name="l00233"></a><a class="code" href="classMyplayer.html#Myplayeri13">00233</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri13">Myplayer::handleRandom</a>(<span class="keywordtype">bool</span> random)
00234 {
00235      <a class="code" href="classMyplayer.html#Myplayerr4">m_random</a> = random;
00236 }
00237 
<a name="l00238"></a><a class="code" href="classMyplayer.html#Myplayeri11">00238</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri11">Myplayer::handlePosition</a>(<span class="keywordtype">int</span> position)
00239 {    
00240      emit <a class="code" href="classMyplayer.html#Myplayerl2">positionMessage</a>(position);     
00241 }
00242 
<a name="l00243"></a><a class="code" href="classMyplayer.html#Myplayeri14">00243</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri14">Myplayer::handleSlider</a>(<span class="keywordtype">int</span> sliderValue)
00244 {
00245      kdDebug() &lt;&lt; <span class="stringliteral">"[Myplayer]sliderValue: "</span>&lt;&lt; sliderValue &lt;&lt; endl;
00246      <a class="code" href="classEngineBase.html">EngineBase</a> *engine = <a class="code" href="classEngineController.html#EngineControllere1">EngineController::engine</a>();
00247      <span class="comment">//if ( engine-&gt;state() == EngineBase::Playing )</span>
00248     <span class="comment">// {</span>
00249         engine-&gt;<a class="code" href="classEngineBase.html#EngineBasei5">seek</a>( sliderValue*1000 );
00250 <span class="comment">//     }</span>
00251 }
00252 
<a name="l00253"></a><a class="code" href="classMyplayer.html#Myplayeri15">00253</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri15">Myplayer::handlePlayItem</a>(KURL &amp;url)
00254 {
00255      KURL::List::Iterator check_it = <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.find(url);      
00256      <span class="keywordflow">if</span>(check_it != <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.end())
00257        {
00258           it = check_it;
00259           <a class="code" href="classMyplayer.html#Myplayeri0">play</a>();
00260           kdDebug() &lt;&lt; <span class="stringliteral">"Find Item "</span>&lt;&lt; endl;
00261        }
00262      <span class="keywordflow">else</span> kdDebug() &lt;&lt; <span class="stringliteral">"NO this item!! "</span> &lt;&lt; endl;
00263 }
00264 
00265 <span class="comment">//===========================================</span>
00266 
<a name="l00267"></a><a class="code" href="classMyplayer.html#Myplayeri17">00267</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri17">Myplayer::add</a>(KURL::List &amp;list)
00268 {     
00269      <span class="keywordflow">if</span>(!<a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.isEmpty())<span class="comment">//Not Empty</span>
00270      {
00271         kdDebug() &lt;&lt; <span class="stringliteral">"PlayList is not empty !!"</span> &lt;&lt; endl;
00272         KURL::List add_list = list;
00273         <span class="keywordflow">for</span>( KURL::List::ConstIterator add_it = add_list.begin();add_it != add_list.end();add_it++)
00274         {
00275               <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.append( (*add_it).url() );
00276         }       
00277      }
00278      <span class="keywordflow">else</span>
00279      {
00280         <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a> = list;
00281         it = <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.begin();
00282         kdDebug() &lt;&lt; <span class="stringliteral">"[Myplayer::add]: "</span> &lt;&lt; (*it).url() &lt;&lt; endl;
00283      }
00284 }
00285 
<a name="l00286"></a><a class="code" href="classMyplayer.html#Myplayeri18">00286</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri18">Myplayer::clearMedia</a>()
00287 {    
00288     <span class="keywordflow">if</span>(<a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.isEmpty())kdDebug() &lt;&lt; <span class="stringliteral">"[Myplayer::clearMedia]: it's empty"</span>&lt;&lt; endl;
00289     <span class="keywordflow">else</span>{
00290        <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.clear();     
00291        kdDebug() &lt;&lt; <span class="stringliteral">"[Myplayer::clearMedia]: it's clear "</span> &lt;&lt; endl;      
00292     }
00293 }
00294 
<a name="l00295"></a><a class="code" href="classMyplayer.html#Myplayeri19">00295</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri19">Myplayer::removeMedia</a>(KURL::List &amp;remove_list)
00296 {       
00297     KURL::List::ConstIterator check_it;
00298         
00299     <span class="keywordflow">if</span>(<a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.isEmpty())kdDebug() &lt;&lt; <span class="stringliteral">"[Myplayer::removeMedia]: it's empty"</span>&lt;&lt; endl;
00300     <span class="keywordflow">else</span>{
00301                 <span class="keywordflow">for</span>( KURL::List::ConstIterator remove_it = remove_list.begin();remove_it != remove_list.end();remove_it++)
00302                 {
00303                         check_it = <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.find((*remove_it).url());      
00304                         <span class="keywordflow">if</span>(check_it != <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.end())
00305                         {
00306                                 <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.remove((*check_it).url());
00307                                 kdDebug() &lt;&lt; <span class="stringliteral">"Remove Item "</span>&lt;&lt; endl;
00308                         }
00309                         <span class="keywordflow">else</span> kdDebug() &lt;&lt; <span class="stringliteral">"NO this item!! "</span> &lt;&lt; endl;
00310                 }
00311         
00312                 <span class="keywordflow">for</span>( KURL::List::ConstIterator refresh_it = <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.begin();refresh_it != <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.end();refresh_it++)  
00313                 {
00314                         <span class="keywordflow">if</span>((*refresh_it).isEmpty())
00315                         {
00316                                 <span class="keywordflow">for</span>(check_it = refresh_it; check_it != <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.end();)
00317                                 (*check_it).url() = (*(check_it++)).url();                  
00318                         }         
00319                 }
00320                 it = <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.begin();   
00321     } 
00322 }
00323 
00324 <span class="comment">//=================Signal======================</span>
00325 
<a name="l00326"></a><a class="code" href="classMyplayer.html#Myplayera2">00326</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayera2">Myplayer::handleMessage</a>(<span class="keyword">const</span> <a class="code" href="classMetaBundle.html">MetaBundle</a> &amp;bundle)
00327 {
00328     <span class="keywordtype">int</span> m_length = bundle.<a class="code" href="classMetaBundle.html#MetaBundlea5">length</a>();
00329     <span class="keywordtype">int</span> m_bitrate = bundle.<a class="code" href="classMetaBundle.html#MetaBundlea6">bitrate</a>();
00330     QString m_title = bundle.<a class="code" href="classMetaBundle.html#MetaBundlea10">title</a>();
00331     QString m_artist = bundle.<a class="code" href="classMetaBundle.html#MetaBundlea11">artist</a>();
00332     QString m_album = bundle.<a class="code" href="classMetaBundle.html#MetaBundlea12">album</a>();
00333 
00334     emit <a class="code" href="classMyplayer.html#Myplayerl0">trackMessage</a>(m_length,m_bitrate,m_title,m_artist,m_album);
00335 }
00336 
00337 <span class="comment">//==============Private=Function==============</span>
00338 
<a name="l00339"></a><a class="code" href="classMyplayer.html#Myplayerd0">00339</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayerd0">Myplayer::savePlaylist</a>()
00340 {
00341     QFile file( <span class="stringliteral">"file.txt"</span> );
00342     <span class="keywordflow">if</span> ( file.open( IO_WriteOnly ) ) {
00343         QTextStream stream( &amp;file );
00344           <span class="keywordflow">for</span>(KURL::List::Iterator save_it = <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.begin(); save_it != <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.end(); ++save_it)
00345             stream &lt;&lt; (*save_it).url() &lt;&lt; <span class="stringliteral">"\n"</span>;
00346         file.close();
00347 kdDebug() &lt;&lt; <span class="stringliteral">"save file finished!!"</span>&lt;&lt; endl;     
00348     }    
00349 }
00350 
<a name="l00351"></a><a class="code" href="classMyplayer.html#Myplayerd1">00351</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayerd1">Myplayer::restorePlaylist</a>()
00352 {
00353     QFile file( <span class="stringliteral">"file.txt"</span> );
00354     <span class="keywordflow">if</span> ( file.open( IO_ReadOnly ) ) {
00355         QTextStream stream( &amp;file );            
00356         <span class="keywordflow">while</span> ( !stream.atEnd() ) {
00357              KURL url(stream.readLine()); <span class="comment">// line of text excluding '\n'         </span>
00358              <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a> &lt;&lt; url;
00359         }
00360         kdDebug() &lt;&lt; <span class="stringliteral">"Load Playlist "</span>&lt;&lt; endl;
00361         file.close();
00362     }
00363 }
<a name="l00364"></a><a class="code" href="classMyplayer.html#Myplayeri16">00364</a> <span class="keywordtype">void</span> <a class="code" href="classMyplayer.html#Myplayeri16">Myplayer::initlist</a>(KURL::List &amp; list)
00365 {
00366   <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>=list;
00367   it = <a class="code" href="classMyplayer.html#Myplayerr0">m_list</a>.begin();
00368   kdDebug() &lt;&lt; <span class="stringliteral">"[Myplayer::add]: "</span> &lt;&lt; (*it).url() &lt;&lt; endl;
00369 }
00370 <span class="preprocessor">#include "<a class="code" href="Myplayer_8moc.html">Myplayer.moc</a>"</span> 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri May 13 16:53:36 2005 for HDASS by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
