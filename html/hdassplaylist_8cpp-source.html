<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>HDASS: hdassplaylist.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>hdassplaylist.cpp</h1><a href="hdassplaylist_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/***************************************************************************</span>
00002 <span class="comment"> *   Copyright (C) 2005 by sonicat                                         *</span>
00003 <span class="comment"> *   is87098@cis.nctu.edu.tw                                               *</span>
00004 <span class="comment"> *                                                                         *</span>
00005 <span class="comment"> *   This program is free software; you can redistribute it and/or modify  *</span>
00006 <span class="comment"> *   it under the terms of the GNU General Public License as published by  *</span>
00007 <span class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</span>
00008 <span class="comment"> *   (at your option) any later version.                                   *</span>
00009 <span class="comment"> *                                                                         *</span>
00010 <span class="comment"> *   This program is distributed in the hope that it will be useful,       *</span>
00011 <span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *</span>
00012 <span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *</span>
00013 <span class="comment"> *   GNU General Public License for more details.                          *</span>
00014 <span class="comment"> *                                                                         *</span>
00015 <span class="comment"> *   You should have received a copy of the GNU General Public License     *</span>
00016 <span class="comment"> *   along with this program; if not, write to the                         *</span>
00017 <span class="comment"> *   Free Software Foundation, Inc.,                                       *</span>
00018 <span class="comment"> *   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.             *</span>
00019 <span class="comment"> ***************************************************************************/</span>
00020 <span class="preprocessor">#include "<a class="code" href="hdassplaylist_8h.html">hdassplaylist.h</a>"</span>
00021 <span class="preprocessor">#include &lt;qtextstream.h&gt;</span>
00022 <span class="preprocessor">#include "<a class="code" href="global__define_8h.html">global_define.h</a>"</span>
00023 <span class="preprocessor">#include &lt;kdebug.h&gt;</span>
<a name="l00024"></a><a class="code" href="classhdassplaylist.html#hdassplaylista0">00024</a> <a class="code" href="classhdassplaylist.html#hdassplaylista0">hdassplaylist::hdassplaylist</a>(QObject *parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name)
00025  : QObject(parent, name)
00026 {
00027     <a class="code" href="classhdassplaylist.html#hdassplaylista2">xSetup</a>();
00028 }
00029 
00030 
<a name="l00031"></a><a class="code" href="classhdassplaylist.html#hdassplaylista1">00031</a> <a class="code" href="classhdassplaylist.html#hdassplaylista1">hdassplaylist::~hdassplaylist</a>()
00032 {
00033      <a class="code" href="classhdassplaylist.html#hdassplaylistd3">SaveList</a>();
00034 }
00035 
<a name="l00036"></a><a class="code" href="classhdassplaylist.html#hdassplaylista2">00036</a> <span class="keywordtype">void</span> <a class="code" href="classhdassplaylist.html#hdassplaylista2">hdassplaylist::xSetup</a>()
00037 {
00038       <span class="comment">//DAVID ReadListFile</span>
00039       <a class="code" href="classhdassplaylist.html#hdassplaylista3">ReadListFile</a>(<a class="code" href="global__define_8h.html#a2">GlobalSetting</a>.<a class="code" href="classHDASSGlobalSetting.html#HDASSGlobalSettingo3">ListFileName</a>);
00040 }
00041 
<a name="l00042"></a><a class="code" href="classhdassplaylist.html#hdassplaylista3">00042</a> <span class="keywordtype">void</span> <a class="code" href="classhdassplaylist.html#hdassplaylista3">hdassplaylist::ReadListFile</a>(QString FileName)
00043 {
00044    <span class="comment">//Clear List</span>
00045    <a class="code" href="classhdassplaylist.html#hdassplaylisto1">url_list</a>.clear();
00046    <span class="comment">//ReadFile</span>
00047    kdDebug()&lt;&lt;FileName&lt;&lt;endl;
00048    <a class="code" href="classhdassplaylist.html#hdassplaylisto0">List</a> =<span class="keyword">new</span> QFile(FileName);
00049    <span class="keywordflow">if</span> ( <a class="code" href="classhdassplaylist.html#hdassplaylisto0">List</a>-&gt;open( IO_ReadOnly ) ) 
00050    {
00051         QTextStream stream( <a class="code" href="classhdassplaylist.html#hdassplaylisto0">List</a> );            
00052         <span class="keywordflow">while</span> ( !stream.atEnd() ) 
00053         {
00054                KURL url(stream.readLine()); <span class="comment">// line of text excluding '\n'</span>
00055                QFile temp(url.path());
00056                <span class="comment">//check if the file exists</span>
00057                <span class="keywordflow">if</span>(temp.exists())
00058                {
00059                        <a class="code" href="classhdassplaylist.html#hdassplaylisto1">url_list</a> &lt;&lt; url;
00060                }         
00061              
00062         }
00063          kdError() &lt;&lt; <span class="stringliteral">"Load Playlist "</span>&lt;&lt; endl;
00064         <a class="code" href="classhdassplaylist.html#hdassplaylisto0">List</a>-&gt;close();
00065     }
00066     <span class="keywordflow">else</span>
00067     {
00068          kdError() &lt;&lt; <span class="stringliteral">"PlayList:: "</span>&lt;&lt;FileName&lt;&lt;<span class="stringliteral">"can't open!!"</span>&lt;&lt; endl;
00069         <a class="code" href="classhdassplaylist.html#hdassplaylisto0">List</a>-&gt;close();
00070     }
00071 }
<a name="l00072"></a><a class="code" href="classhdassplaylist.html#hdassplaylisti0">00072</a> <span class="keywordtype">void</span> <a class="code" href="classhdassplaylist.html#hdassplaylisti0">hdassplaylist::slotPLRequest</a>()
00073 {
00074   <span class="comment">//DAVID emit the playlist</span>
00075  
00076   qWarning(<span class="stringliteral">"hdassplaylist::slotPLRequest()"</span>);
00077   emit <a class="code" href="classhdassplaylist.html#hdassplaylistl0">signalPLSend</a>(<a class="code" href="classhdassplaylist.html#hdassplaylisto1">url_list</a>);
00078   
00079 }
<a name="l00080"></a><a class="code" href="classhdassplaylist.html#hdassplaylisti1">00080</a> <span class="keywordtype">void</span> <a class="code" href="classhdassplaylist.html#hdassplaylisti1">hdassplaylist::slotReciveList</a>(KURL::List list,HDASS_ACTION_TYPE act)
00081 {
00082   <span class="keywordflow">if</span>(act==<a class="code" href="enum_8h.html#a24a17">em_remove</a>)
00083   {
00084    <a class="code" href="classhdassplaylist.html#hdassplaylistd0">RemoveList</a>(list);
00085    <a class="code" href="classhdassplaylist.html#hdassplaylistd3">SaveList</a>();
00086   }
00087   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(act==<a class="code" href="enum_8h.html#a24a19">em_paste</a>)
00088   {
00089     <a class="code" href="classhdassplaylist.html#hdassplaylistd1">CutList</a>(list);
00090     <a class="code" href="classhdassplaylist.html#hdassplaylistd3">SaveList</a>();
00091   }
00092   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(act==<a class="code" href="enum_8h.html#a24a18">em_cut</a>)
00093   {
00094     <a class="code" href="classhdassplaylist.html#hdassplaylistd2">PasteList</a>();
00095     <a class="code" href="classhdassplaylist.html#hdassplaylistd3">SaveList</a>();
00096   }
00097   <span class="keywordflow">else</span> 
00098   {
00099     <a class="code" href="classhdassplaylist.html#hdassplaylistd4">AppendList</a>(list);
00100     <a class="code" href="classhdassplaylist.html#hdassplaylistd3">SaveList</a>();
00101   }
00102   
00103 }
<a name="l00104"></a><a class="code" href="classhdassplaylist.html#hdassplaylistd0">00104</a> <span class="keywordtype">void</span> <a class="code" href="classhdassplaylist.html#hdassplaylistd0">hdassplaylist::RemoveList</a>(KURL::List removelist)
00105 {
00106    <span class="keywordflow">for</span>(KURL::List::ConstIterator remove_it = removelist.begin();remove_it != removelist.end();remove_it++)
00107    {
00108       <a class="code" href="classhdassplaylist.html#hdassplaylisto1">url_list</a>.remove(*remove_it);
00109    }
00110    emit <a class="code" href="classhdassplaylist.html#hdassplaylistl0">signalPLSend</a>(<a class="code" href="classhdassplaylist.html#hdassplaylisto1">url_list</a>);
00111 }
<a name="l00112"></a><a class="code" href="classhdassplaylist.html#hdassplaylistd1">00112</a> <span class="keywordtype">void</span> <a class="code" href="classhdassplaylist.html#hdassplaylistd1">hdassplaylist::CutList</a>(KURL::List cutlist)
00113 {  
00114   <a class="code" href="classhdassplaylist.html#hdassplaylisto2">url_list_cut_buffer</a>=cutlist;
00115   <a class="code" href="classhdassplaylist.html#hdassplaylistd0">RemoveList</a>(cutlist);
00116 }
<a name="l00117"></a><a class="code" href="classhdassplaylist.html#hdassplaylistd2">00117</a> <span class="keywordtype">void</span> <a class="code" href="classhdassplaylist.html#hdassplaylistd2">hdassplaylist::PasteList</a>()
00118 {
00119    <span class="keywordflow">for</span>(KURL::List::ConstIterator paste_it = <a class="code" href="classhdassplaylist.html#hdassplaylisto2">url_list_cut_buffer</a>.begin();paste_it != <a class="code" href="classhdassplaylist.html#hdassplaylisto2">url_list_cut_buffer</a>.end();paste_it++)
00120    {
00121       <a class="code" href="classhdassplaylist.html#hdassplaylisto1">url_list</a>.append(*paste_it);
00122    }
00123    emit <a class="code" href="classhdassplaylist.html#hdassplaylistl0">signalPLSend</a>(<a class="code" href="classhdassplaylist.html#hdassplaylisto1">url_list</a>);
00124 }
<a name="l00125"></a><a class="code" href="classhdassplaylist.html#hdassplaylistd3">00125</a> <span class="keywordtype">void</span> <a class="code" href="classhdassplaylist.html#hdassplaylistd3">hdassplaylist::SaveList</a>()
00126 {
00127   <span class="comment">//DAVID New Save List File</span>
00128   <a class="code" href="classhdassplaylist.html#hdassplaylisto0">List</a> =<span class="keyword">new</span> QFile(<a class="code" href="global__define_8h.html#a2">GlobalSetting</a>.<a class="code" href="classHDASSGlobalSetting.html#HDASSGlobalSettingo3">ListFileName</a>);
00129    <span class="keywordflow">if</span> ( <a class="code" href="classhdassplaylist.html#hdassplaylisto0">List</a>-&gt;open( IO_WriteOnly ) ) 
00130    {
00131         QTextStream stream( <a class="code" href="classhdassplaylist.html#hdassplaylisto0">List</a> );
00132         <span class="keywordflow">for</span>( KURL::List::ConstIterator iterator = <a class="code" href="classhdassplaylist.html#hdassplaylisto1">url_list</a>.begin();iterator != <a class="code" href="classhdassplaylist.html#hdassplaylisto1">url_list</a>.end();iterator++)
00133         {       
00134             <span class="keywordflow">if</span>(!(*iterator). isEmpty())
00135             {
00136                                 <span class="comment">//DAVID Write to the file</span>
00137                 stream&lt;&lt;<span class="stringliteral">"file:"</span>&lt;&lt;((*iterator).path())&lt;&lt;endl;
00138             }   
00139         }   
00140         qWarning(<span class="stringliteral">"SavePlayLists!!"</span>);
00141         <a class="code" href="classhdassplaylist.html#hdassplaylisto0">List</a>-&gt;close();
00142     }
00143     <span class="keywordflow">else</span>
00144     {
00145         
00146         qWarning(<span class="stringliteral">"PlayList can't be opened"</span>);
00147         <a class="code" href="classhdassplaylist.html#hdassplaylisto0">List</a>-&gt;close();
00148     }
00149   
00150 }
00151 
<a name="l00152"></a><a class="code" href="classhdassplaylist.html#hdassplaylistd4">00152</a> <span class="keywordtype">void</span> <a class="code" href="classhdassplaylist.html#hdassplaylistd4">hdassplaylist::AppendList</a>(KURL::List list)
00153 {
00154     <span class="keywordflow">for</span>(KURL::List::ConstIterator append_it = list.begin();append_it != list.end();append_it++)
00155    {
00156       <a class="code" href="classhdassplaylist.html#hdassplaylisto1">url_list</a>.append(*append_it);
00157    }
00158    emit <a class="code" href="classhdassplaylist.html#hdassplaylistl0">signalPLSend</a>(<a class="code" href="classhdassplaylist.html#hdassplaylisto1">url_list</a>);
00159 }
00160 <span class="preprocessor">#include "<a class="code" href="hdassplaylist_8moc.html">hdassplaylist.moc</a>"</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri May 13 16:53:35 2005 for HDASS by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
