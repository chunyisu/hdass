<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>HDASS: hdassalbum.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>hdassalbum.cpp</h1><a href="hdassalbum_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/***************************************************************************</span>
00002 <span class="comment"> *   Copyright (C) 2004 by root                                            *</span>
00003 <span class="comment"> *   root@colicoli                                                         *</span>
00004 <span class="comment"> *                                                                         *</span>
00005 <span class="comment"> *   This program is free software; you can redistribute it and/or modify  *</span>
00006 <span class="comment"> *   it under the terms of the GNU General Public License as published by  *</span>
00007 <span class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</span>
00008 <span class="comment"> *   (at your option) any later version.                                   *</span>
00009 <span class="comment"> *                                                                         *</span>
00010 <span class="comment"> *   This program is distributed in the hope that it will be useful,       *</span>
00011 <span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *</span>
00012 <span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *</span>
00013 <span class="comment"> *   GNU General Public License for more details.                          *</span>
00014 <span class="comment"> *                                                                         *</span>
00015 <span class="comment"> *   You should have received a copy of the GNU General Public License     *</span>
00016 <span class="comment"> *   along with this program; if not, write to the                         *</span>
00017 <span class="comment"> *   Free Software Foundation, Inc.,                                       *</span>
00018 <span class="comment"> *   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.             *</span>
00019 <span class="comment"> ***************************************************************************/</span>
00020 <span class="preprocessor"> #include "<a class="code" href="hdassalbum_8h.html">hdassalbum.h</a>"</span>
00021 <span class="preprocessor">#include &lt;kdebug.h&gt;</span>
00022 <span class="preprocessor">#include &lt;qpainter.h&gt;</span>
00023 <span class="preprocessor">#include &lt;qimage.h&gt;</span>
00024 <span class="preprocessor">#include &lt;qdir.h&gt;</span>
00025 <span class="preprocessor">#include &lt;qstringlist.h&gt;</span>
<a name="l00026"></a><a class="code" href="classhdassAlbum.html#hdassAlbuma0">00026</a> <a class="code" href="classhdassAlbum.html#hdassAlbuma0">hdassAlbum::hdassAlbum</a>(<a class="code" href="classQWidget.html">QWidget</a> *parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name)
00027  : <a class="code" href="classQWidget.html">QWidget</a>(parent, name)
00028 {
00029    <a class="code" href="classhdassAlbum.html#ImageDetiala2">xSetup</a>();
00030 }
00031 
00032 
<a name="l00033"></a><a class="code" href="classhdassAlbum.html#hdassAlbuma1">00033</a> <a class="code" href="classhdassAlbum.html#hdassAlbuma1">hdassAlbum::~hdassAlbum</a>()
00034 {
00035 
00036 }
00037 
<a name="l00038"></a><a class="code" href="classhdassAlbum.html#ImageDetiala2">00038</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#ImageDetiala2">hdassAlbum::xSetup</a>()
00039 {
00040   <span class="comment">//DAVID Read album file list </span>
00041   <a class="code" href="classhdassAlbum.html#hdassAlbumr1">AlbumListFileName</a>=<span class="stringliteral">"AlbumList.txt"</span>;
00042   <a class="code" href="classhdassAlbum.html#hdassAlbumd0">ReadAlbumList</a>(<a class="code" href="classhdassAlbum.html#hdassAlbumr1">AlbumListFileName</a>);
00043   
00044  
00045 
00046   <span class="comment">//DAVID Set the switching time</span>
00047   <a class="code" href="classhdassAlbum.html#hdassAlbumr0">switchtime</a>=3;
00048   <span class="comment">//DAVID Set the timer</span>
00049   <a class="code" href="classhdassAlbum.html#hdassAlbumr3">timer</a> =<span class="keyword">new</span> QTimer(<span class="keyword">this</span>);
00050   connect(<a class="code" href="classhdassAlbum.html#hdassAlbumr3">timer</a>,SIGNAL(timeout()),<span class="keyword">this</span>,SLOT(<a class="code" href="classhdassAlbum.html#ImageDetiali4">slotNextImage</a>()));
00051   
00052   <span class="comment">//DAVID Draw a pix first</span>
00053   KURL url((*it).url());
00054   QPixmap pix;
00055   pix.load(url.path());
00056   <a class="code" href="classhdassAlbum.html#ImageDetiala4">DrawImage</a>(pix);
00057   <a class="code" href="classhdassAlbum.html#hdassAlbumr3">timer</a>-&gt;stop();
00058   
00059 }
<a name="l00060"></a><a class="code" href="classhdassAlbum.html#ImageDetiali1">00060</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#ImageDetiali1">hdassAlbum::AddImageToAlbum</a>(KURL addimage)
00061 {
00062    <a class="code" href="classhdassAlbum.html#ImageDetialo1">AlbumList</a>&lt;&lt;addimage;
00063 }
00064 
<a name="l00065"></a><a class="code" href="classhdassAlbum.html#ImageDetiali2">00065</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#ImageDetiali2">hdassAlbum::RemoveImageFromAlbum</a>(KURL removeimage)
00066 {
00067   <a class="code" href="classhdassAlbum.html#ImageDetialo1">AlbumList</a>.remove(removeimage);
00068 }
<a name="l00069"></a><a class="code" href="classhdassAlbum.html#ImageDetiali3">00069</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#ImageDetiali3">hdassAlbum::ChangeMode</a>(AlbumMode mode)
00070 {
00071 
00072 }
<a name="l00073"></a><a class="code" href="classhdassAlbum.html#ImageDetiali7">00073</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#ImageDetiali7">hdassAlbum::slotModeChange</a>(<span class="keywordtype">int</span> mode)
00074 {
00075 
00076 }
<a name="l00077"></a><a class="code" href="classhdassAlbum.html#hdassAlbumd0">00077</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#hdassAlbumd0">hdassAlbum::ReadAlbumList</a>(QString filepath)
00078 {
00079         <span class="comment">//DAVID open the file</span>
00080         <a class="code" href="classhdassAlbum.html#hdassAlbumr2">AlbumFile</a>=<span class="keyword">new</span> QFile(filepath);
00081         <span class="keywordflow">if</span>(<a class="code" href="classhdassAlbum.html#hdassAlbumr2">AlbumFile</a>-&gt;open(IO_ReadOnly))
00082         {
00083                 <span class="comment">//Read KURL from file to KURLList</span>
00084                 QTextStream stream( <a class="code" href="classhdassAlbum.html#hdassAlbumr2">AlbumFile</a> );
00085                 <span class="keywordflow">while</span>(!stream.atEnd())
00086                 {
00087                         KURL url(stream.readLine());
00088                         <span class="comment">//kdDebug()&lt;&lt;url.path();</span>
00089                         <a class="code" href="classhdassAlbum.html#ImageDetialo1">AlbumList</a>&lt;&lt;url;
00090                 }
00091         }
00092         <span class="keywordflow">else</span>
00093         {
00094                 kdDebug()&lt;&lt;<span class="stringliteral">"hdassAlbum::ReadAlbumList ::: file not opened!!"</span>;
00095         }
00096         <a class="code" href="classhdassAlbum.html#ImageDetialo0">it</a>=<a class="code" href="classhdassAlbum.html#ImageDetialo1">AlbumList</a>.begin();
00097 }
00098 
<a name="l00099"></a><a class="code" href="classhdassAlbum.html#hdassAlbumd1">00099</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#hdassAlbumd1">hdassAlbum::SaveAlbumList</a>()
00100 {
00101 
00102 }
00103 
<a name="l00104"></a><a class="code" href="classhdassAlbum.html#ImageDetiali5">00104</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#ImageDetiali5">hdassAlbum::slotPreviousImage</a>()
00105 {
00106         <span class="comment">//DAVID Read Image</span>
00107         <a class="code" href="classhdassAlbum.html#ImageDetialo0">it</a>--;
00108         <span class="keywordflow">if</span>(<a class="code" href="classhdassAlbum.html#ImageDetialo0">it</a>!=<a class="code" href="classhdassAlbum.html#ImageDetialo1">AlbumList</a>.end())
00109         {
00110                 KURL url((*it).url());
00111                 QPixmap pix;
00112                 pix.load(url.path());
00113                 <a class="code" href="classhdassAlbum.html#ImageDetiala4">DrawImage</a>(pix);
00114         }
00115 }
00116 
<a name="l00117"></a><a class="code" href="classhdassAlbum.html#ImageDetiali4">00117</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#ImageDetiali4">hdassAlbum::slotNextImage</a>()
00118 {
00119         <span class="comment">//DAVID Read Image</span>
00120         <a class="code" href="classhdassAlbum.html#ImageDetialo0">it</a>++;
00121         <span class="keywordflow">if</span>(<a class="code" href="classhdassAlbum.html#ImageDetialo0">it</a>!=<a class="code" href="classhdassAlbum.html#ImageDetialo1">AlbumList</a>.end())
00122         {
00123                 KURL url((*it).url());
00124                 QPixmap pix;
00125                 pix.load(url.path());
00126                 <a class="code" href="classhdassAlbum.html#ImageDetiala4">DrawImage</a>(pix);
00127         }
00128 }
00129 
<a name="l00130"></a><a class="code" href="classhdassAlbum.html#ImageDetiali6">00130</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#ImageDetiali6">hdassAlbum::slotPlayNStop</a>()
00131 {
00132         <span class="keywordflow">if</span>(<a class="code" href="classhdassAlbum.html#hdassAlbumr3">timer</a>-&gt;isActive ())
00133         {
00134                 <a class="code" href="classhdassAlbum.html#hdassAlbumr3">timer</a>-&gt;stop();
00135         }
00136         <span class="keywordflow">else</span>
00137         {
00138                 <a class="code" href="classhdassAlbum.html#hdassAlbumr3">timer</a>-&gt;start(<a class="code" href="classhdassAlbum.html#hdassAlbumr0">switchtime</a>*1000,FALSE);
00139         }
00140 }
00141 
00142 
<a name="l00143"></a><a class="code" href="classhdassAlbum.html#ImageDetiali8">00143</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#ImageDetiali8">hdassAlbum::slotSetSwitchingTime</a>(<span class="keywordtype">int</span> time)
00144 {
00145   <a class="code" href="classhdassAlbum.html#hdassAlbumr0">switchtime</a>=time;
00146 }
00147 
<a name="l00148"></a><a class="code" href="classhdassAlbum.html#ImageDetiala3">00148</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#ImageDetiala3">hdassAlbum::SlideShow</a>()
00149 {
00150      qWarning(<span class="stringliteral">"hdassAlbum::SlideShow()!!"</span>);
00151      <a class="code" href="classhdassAlbum.html#hdassAlbumr3">timer</a>-&gt;start(<a class="code" href="classhdassAlbum.html#hdassAlbumr0">switchtime</a>*1000,FALSE);
00152 }
00153 
<a name="l00154"></a><a class="code" href="classhdassAlbum.html#ImageDetiala4">00154</a> <span class="keywordtype">void</span> <a class="code" href="classhdassAlbum.html#ImageDetiala4">hdassAlbum::DrawImage</a>(QPixmap pix)
00155 {
00156    
00157    
00158    <span class="keywordtype">int</span> width ,height;
00159    width=pix.width();
00160    height=pix.height();
00161    
00162    QPixmap draw(QSize(800,540));
00163    QPainter p(&amp;draw);
00164 
00165    p.fillRect(0,0,800,540,Qt::black);
00166    <span class="keywordflow">if</span>(width&lt;800&amp;&amp;height&lt;540)
00167    {
00168        <span class="comment">//DAVID draw image at center</span>
00169        p.drawPixmap((400-width/2),(270-height/2),pix);
00170    }
00171 
00172    <span class="keywordflow">else</span>
00173    {
00174         <span class="keywordflow">if</span>(11*width&gt;20*height)
00175         {
00176                 <span class="keywordtype">int</span> newheight=(800*height/width);
00177                 QImage rescale=pix.convertToImage().scale(800,newheight);
00178                 p.drawImage(0,270-newheight/2,rescale);
00179                 
00180         } 
00181         <span class="keywordflow">else</span>
00182         {
00183                 <span class="keywordtype">int</span> newwidth=(540*width/height);
00184                 QImage rescale=pix.convertToImage().scale(newwidth,540);
00185                 p.drawImage((400-newwidth/2),0,rescale);
00186         }
00187    }    
00188    p.end();
00189    setBackgroundPixmap(draw);
00190 }
00191 
00192 
00193 <span class="preprocessor">#include "<a class="code" href="hdassalbum_8moc.html">hdassalbum.moc</a>"</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri May 13 16:53:35 2005 for HDASS by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
