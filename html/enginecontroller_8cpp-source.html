<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>HDASS: enginecontroller.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>enginecontroller.cpp</h1><a href="enginecontroller_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/***************************************************************************</span>
00002 <span class="comment">                      enginecontroller.cpp  -  Wraps engine and adds some functionality</span>
00003 <span class="comment">                         -------------------</span>
00004 <span class="comment">begin                : Mar 15 2004</span>
00005 <span class="comment">copyright            : (C) 2004 by Frederik Holljen</span>
00006 <span class="comment">email                : fh@ez.no</span>
00007 <span class="comment">***************************************************************************/</span>
00008 
00009 <span class="comment">/***************************************************************************</span>
00010 <span class="comment"> *                                                                         *</span>
00011 <span class="comment"> *   This program is free software; you can redistribute it and/or modify  *</span>
00012 <span class="comment"> *   it under the terms of the GNU General Public License as published by  *</span>
00013 <span class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</span>
00014 <span class="comment"> *   (at your option) any later version.                                   *</span>
00015 <span class="comment"> *                                                                         *</span>
00016 <span class="comment"> ***************************************************************************/</span>
00017 
00018 <span class="preprocessor">#include "<a class="code" href="enginecontroller_8h.html">enginecontroller.h</a>"</span>
00019 <span class="preprocessor">#include "<a class="code" href="enginebase_8h.html">enginebase.h</a>"</span>
00020 <span class="preprocessor">#include "<a class="code" href="amarokconfig_8h.html">amarokconfig.h</a>"</span>
00021 <span class="preprocessor">#include "<a class="code" href="metabundle_8h.html">metabundle.h</a>"</span>
00022 <span class="comment">//#include "titleproxy.h"</span>
00023 
00024 <span class="preprocessor">#include &lt;kdebug.h&gt;</span>
00025 <span class="preprocessor">#include &lt;qtimer.h&gt;</span>
00026 <span class="preprocessor">#include &lt;kurl.h&gt;</span>
00027 
<a name="l00028"></a><a class="code" href="classDummyEngine.html">00028</a> <span class="keyword">class </span><a class="code" href="classDummyEngine.html">DummyEngine</a> : <span class="keyword">public</span> <a class="code" href="classEngineBase.html">EngineBase</a>
00029 {
00030     <span class="comment">//Does nothing, just here to prevent crashes on startup</span>
00031     <span class="comment">//and in case no engines are found</span>
00032 
<a name="l00033"></a><a class="code" href="classDummyEngine.html#DummyEngined0">00033</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classDummyEngine.html#DummyEngined0">init</a>( <span class="keywordtype">bool</span>&amp;, <span class="keywordtype">int</span>, <span class="keywordtype">bool</span> ) {}
<a name="l00034"></a><a class="code" href="classDummyEngine.html#DummyEngined1">00034</a>     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classDummyEngine.html#DummyEngined1">initMixer</a>( <span class="keywordtype">bool</span> ) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }
<a name="l00035"></a><a class="code" href="classDummyEngine.html#DummyEngined2">00035</a>     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classDummyEngine.html#DummyEngined2">canDecode</a>( <span class="keyword">const</span> KURL&amp;, mode_t, mode_t ) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }
<a name="l00036"></a><a class="code" href="classDummyEngine.html#DummyEngined3">00036</a>     <span class="keyword">virtual</span> <span class="keywordtype">long</span> <a class="code" href="classDummyEngine.html#DummyEngined3">length</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00037"></a><a class="code" href="classDummyEngine.html#DummyEngined4">00037</a>     <span class="keyword">virtual</span> <span class="keywordtype">long</span> <a class="code" href="classDummyEngine.html#DummyEngined4">position</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00038"></a><a class="code" href="classDummyEngine.html#DummyEngined5">00038</a>     <span class="keyword">virtual</span> EngineState <a class="code" href="classDummyEngine.html#DummyEngined5">state</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> EngineBase::Empty; }
<a name="l00039"></a><a class="code" href="classDummyEngine.html#DummyEngined6">00039</a>     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classDummyEngine.html#DummyEngined6">isStream</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">false</span>; }
<a name="l00040"></a><a class="code" href="classDummyEngine.html#DummyEngined7">00040</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classDummyEngine.html#DummyEngined8">play</a>( <span class="keyword">const</span> KURL&amp; ) {}
<a name="l00041"></a><a class="code" href="classDummyEngine.html#DummyEngined8">00041</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classDummyEngine.html#DummyEngined8">play</a>() {}
<a name="l00042"></a><a class="code" href="classDummyEngine.html#DummyEngined9">00042</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classDummyEngine.html#DummyEngined9">stop</a>() {}
<a name="l00043"></a><a class="code" href="classDummyEngine.html#DummyEngined10">00043</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classDummyEngine.html#DummyEngined10">pause</a>() {}
00044 
<a name="l00045"></a><a class="code" href="classDummyEngine.html#DummyEngined11">00045</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classDummyEngine.html#DummyEngined11">seek</a>( <span class="keywordtype">long</span> ) {}
<a name="l00046"></a><a class="code" href="classDummyEngine.html#DummyEngined12">00046</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classDummyEngine.html#DummyEngined12">setVolume</a>( <span class="keywordtype">int</span> v ) { m_volume = v; }
00047 
<a name="l00048"></a><a class="code" href="classDummyEngine.html#DummyEnginea0">00048</a> <span class="keyword">public</span>: <a class="code" href="classDummyEngine.html#DummyEnginea0">DummyEngine</a>() : <a class="code" href="classEngineBase.html">EngineBase</a>() { setName( <span class="stringliteral">"Dummy"</span> ); }
00049 
00050 } <a class="code" href="enginecontroller_8cpp.html#a0">dummyEngine</a>;
00051 
00052 
<a name="l00053"></a><a class="code" href="classEngineController.html#EngineControllere0">00053</a> <a class="code" href="classEngineController.html">EngineController</a> *<a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()
00054 {
00055     <span class="comment">//will only be instantiated the first time this function is called</span>
00056     <span class="keyword">static</span> <a class="code" href="classEngineController.html">EngineController</a> Instance;
00057 
00058     <span class="keywordflow">return</span> &amp;Instance;
00059 }
00060 
<a name="l00061"></a><a class="code" href="classEngineController.html#EngineControllerd0">00061</a> <a class="code" href="classEngineController.html#EngineControllerd0">EngineController::EngineController</a>()
00062 
00063     <span class="comment">//we use the dummy Engine to ensure we always have an engine and don't have to test for</span>
00064     <span class="comment">//m_pEngine == 0 and amaroK is in a safe state before an engine is loaded on startup</span>
00065 
00066     : m_pEngine( &amp;<a class="code" href="enginecontroller_8cpp.html#a0">dummyEngine</a> ) <span class="comment">//FIXME better would be a static member or something</span>
00067     , m_proxyError( false )
00068     , m_pMainTimer( new QTimer( this ) )
00069     , m_delayTime( 0 )
00070 {
00071     <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasei4">setVolume</a>( AmarokConfig::masterVolume() );
00072 
00073     connect( <a class="code" href="classEngineController.html#EngineControllerr3">m_pMainTimer</a>, SIGNAL( timeout() ), <span class="keyword">this</span>, SLOT( <a class="code" href="classEngineController.html#EngineControllerk0">slotMainTimer</a>() ) );
00074     <a class="code" href="classEngineController.html#EngineControllerr3">m_pMainTimer</a>-&gt;start( <a class="code" href="classEngineController.html#EngineControllerv0">MAIN_TIMER</a> );
00075 }
00076 
<a name="l00077"></a><a class="code" href="classEngineController.html#EngineControllera0">00077</a> <a class="code" href="classEngineController.html#EngineControllera0">EngineController::~EngineController</a>()
00078 {
00079 kdDebug() &lt;&lt; k_funcinfo &lt;&lt; endl;
00080 }
00081 
00082 
<a name="l00083"></a><a class="code" href="classEngineController.html#EngineControlleri0">00083</a> <span class="keywordtype">void</span> <a class="code" href="classEngineController.html#EngineControlleri0">EngineController::previous</a>()
00084 {
00085     emit <a class="code" href="classEngineController.html#EngineControllerl1">orderPrevious</a>();
00086 }
00087 
00088 
00089 
<a name="l00090"></a><a class="code" href="classEngineController.html#EngineControlleri1">00090</a> <span class="keywordtype">void</span> <a class="code" href="classEngineController.html#EngineControlleri1">EngineController::next</a>()
00091 {
00092     kdDebug() &lt;&lt; <span class="stringliteral">"EngineController-&gt;next"</span> &lt;&lt; endl;
00093     emit <a class="code" href="classEngineController.html#EngineControllerl0">orderNext</a>();
00094 }
00095 
00096 
00097 
<a name="l00098"></a><a class="code" href="classEngineController.html#EngineControlleri6">00098</a> <span class="keywordtype">void</span> <a class="code" href="classEngineController.html#EngineControlleri6">EngineController::playPause</a>()
00099 {
00100 <span class="comment">/*    //this is used by the TrayIcon and PlayPauseAction</span>
00101 <span class="comment"></span>
00102 <span class="comment">    if( m_pEngine-&gt;state() == EngineBase::Playing )</span>
00103 <span class="comment">    {</span>
00104 <span class="comment">        pause();</span>
00105 <span class="comment">    }</span>
00106 <span class="comment">    else play();*/</span>
00107 }
00108 
00109 
00110 
<a name="l00111"></a><a class="code" href="classEngineController.html#EngineControlleri2">00111</a> <span class="keywordtype">void</span> <a class="code" href="classEngineController.html#EngineControlleri2">EngineController::play</a>(<span class="keyword">const</span> <a class="code" href="classMetaBundle.html">MetaBundle</a> &amp;bundle)
00112 {
00113 qWarning(<span class="stringliteral">"[EngineController::play]"</span>);
00114     <span class="keywordflow">if</span> ( <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea8">state</a>() == EngineBase::Paused )
00115     {
00116         <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasei0">play</a>();
00117         <a class="code" href="classEngineSubject.html#EngineSubjectb2">stateChangedNotify</a>( EngineBase::Playing );
00118 qWarning(<span class="stringliteral">"Pause-&gt;play"</span>);        
00119     }
00120     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea8">state</a>() == EngineBase::Playing )
00121     {
00122         <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri4">pause</a>();  
00123         
00124 qWarning(<span class="stringliteral">"play-&gt;pause"</span>);        
00125     }
00126     <span class="keywordflow">else</span> 
00127     {
00128          <a class="code" href="classEngineController.html#EngineControllere0">EngineController::instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControlleri2">play</a>(<span class="keyword">true</span>,bundle);
00129         
00130 qWarning(<span class="stringliteral">"other situation"</span>);    
00131     }   
00132 <span class="comment">//        emit orderCurrent(); // keep currenttrack to avoid signal?</span>
00133 }
00134 
00135 
<a name="l00136"></a><a class="code" href="classEngineController.html#EngineControlleri3">00136</a> <span class="keywordtype">void</span> <a class="code" href="classEngineController.html#EngineControlleri2">EngineController::play</a>(<span class="keywordtype">bool</span> test,<span class="keyword">const</span> <a class="code" href="classMetaBundle.html">MetaBundle</a> &amp;bundle)
00137 {
00138         <span class="keyword">const</span> KURL &amp;trackurl = bundle.<a class="code" href="classMetaBundle.html#MetaBundlea9">url</a>();    
00139         kdDebug() &lt;&lt; <span class="stringliteral">"[enginecontroller]SoundSystem: "</span> &lt;&lt; bundle.<a class="code" href="classMetaBundle.html#MetaBundlea9">url</a>() &lt;&lt; endl;
00140         <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasei0">play</a>( trackurl );    
00141 
00142    <span class="comment">//  kdDebug() &lt;&lt; "[engine] It's Playing: " &lt;&lt; bundle.track() &lt;&lt; endl;</span>
00143 
00144     <a class="code" href="classEngineSubject.html#EngineSubjectb2">stateChangedNotify</a>( EngineBase::Playing );
00145     <a class="code" href="classEngineSubject.html#EngineSubjectb3">newMetaDataNotify</a>( bundle, <span class="keyword">true</span> <span class="comment">/* track change */</span> );
00146       
00147 }
00148 
00149 
<a name="l00150"></a><a class="code" href="classEngineController.html#EngineControlleri4">00150</a> <span class="keywordtype">void</span> <a class="code" href="classEngineController.html#EngineControlleri4">EngineController::pause</a>()
00151 {
00152     <span class="keywordflow">if</span> ( <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea9">loaded</a>() )
00153     {
00154         <span class="keywordflow">if</span> ( <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea8">state</a>() == EngineBase::Paused )
00155             <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasei0">play</a>();
00156         <span class="keywordflow">else</span>
00157             <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasei3">pause</a>();
00158         <a class="code" href="classEngineSubject.html#EngineSubjectb2">stateChangedNotify</a>( <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea8">state</a>() );
00159     }
00160 }
00161 
00162 
00163 
<a name="l00164"></a><a class="code" href="classEngineController.html#EngineControlleri5">00164</a> <span class="keywordtype">void</span> <a class="code" href="classEngineController.html#EngineControlleri5">EngineController::stop</a>()
00165 {
00166 <span class="comment">/*    m_bundle = MetaBundle(); */</span>
00167     <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasei2">stop</a>();
00168     <a class="code" href="classEngineSubject.html#EngineSubjectb2">stateChangedNotify</a>( <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea8">state</a>() );  
00169 }
00170 
00171 
00172 
<a name="l00173"></a><a class="code" href="classEngineController.html#EngineControlleri7">00173</a> <span class="keywordtype">int</span> <a class="code" href="classEngineController.html#EngineControlleri7">EngineController::increaseVolume</a>( <span class="keywordtype">int</span> ticks )
00174 {
00175     <span class="keywordflow">return</span> <a class="code" href="classEngineController.html#EngineControlleri9">setVolume</a>( <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea10">volume</a>() + ticks );
00176 }
00177 
00178 
00179 
<a name="l00180"></a><a class="code" href="classEngineController.html#EngineControlleri8">00180</a> <span class="keywordtype">int</span> <a class="code" href="classEngineController.html#EngineControlleri8">EngineController::decreaseVolume</a>( <span class="keywordtype">int</span> ticks )
00181 {
00182     <span class="keywordflow">return</span> <a class="code" href="classEngineController.html#EngineControlleri9">setVolume</a>( <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea10">volume</a>() - ticks );
00183 }
00184 
00185 
<a name="l00186"></a><a class="code" href="classEngineController.html#EngineControllere2">00186</a> <span class="keywordtype">void</span> <a class="code" href="classEngineController.html#EngineControllere2">EngineController::setEngine</a>( <a class="code" href="classEngineBase.html">EngineBase</a> *engine )
00187 {
00188     <a class="code" href="classEngineController.html#EngineControllere0">instance</a>()-&gt;<a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a> = engine;
00189     kdDebug() &lt;&lt; <span class="stringliteral">"[enginecontroller]engine: "</span> &lt;&lt; engine &lt;&lt; endl;
00190     <span class="comment">//NOTE many engine properties are only set in applySettings</span>
00191 }
00192 
<a name="l00193"></a><a class="code" href="classEngineController.html#EngineControlleri9">00193</a> <span class="keywordtype">int</span> <a class="code" href="classEngineController.html#EngineControlleri9">EngineController::setVolume</a>( <span class="keywordtype">int</span> percent )
00194 {
00195     <span class="keywordflow">if</span>( percent &lt; 0 ) percent = 0; <span class="comment">//can't make uint as all signals use int and slot has to match</span>
00196     <span class="keywordflow">if</span>( percent &gt; 100 ) percent = 100;
00197 
00198     <span class="keywordflow">if</span>( percent != <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea10">volume</a>() )
00199     {
00200         <a class="code" href="classAmarokConfig.html#AmarokConfige51">AmarokConfig::setMasterVolume</a>( percent );
00201 
00202         <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasei4">setVolume</a>( percent );
00203 
00204         <a class="code" href="classEngineSubject.html#EngineSubjectb4">volumeChangedNotify</a>( percent );
00205     }
00206 
00207     <span class="keywordflow">return</span> <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea10">volume</a>();
00208 }
00209 
00210 
<a name="l00211"></a><a class="code" href="classEngineController.html#EngineControllerk1">00211</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEngineController.html#EngineControllerk1">EngineController::newMetaData</a>( <span class="keyword">const</span> <a class="code" href="classMetaBundle.html">MetaBundle</a> &amp;bundle )
00212 {
00213 <span class="comment">/*    m_bundle = bundle;</span>
00214 <span class="comment"></span>
00215 <span class="comment">//    newMetaDataNotify( m_bundle, false  );*/</span>
00216 }
00217 
00218 
00219 
<a name="l00220"></a><a class="code" href="classEngineController.html#EngineControllerk0">00220</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEngineController.html#EngineControllerk0">EngineController::slotMainTimer</a>()
00221 {
00222     <span class="keywordflow">if</span>( <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea8">state</a>() == EngineBase::Empty ) <span class="keywordflow">return</span>;
00223     <span class="keyword">const</span> uint position = <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea7">position</a>();
00224     <span class="keyword">const</span> uint length   = <a class="code" href="classEngineController.html#EngineControllerr1">m_bundle</a>.<a class="code" href="classMetaBundle.html#MetaBundlea5">length</a>() * 1000;
00225 
00226     <a class="code" href="classEngineSubject.html#EngineSubjectb5">trackPositionChangedNotify</a>( position );
00227 
00228     <span class="comment">// check if track has ended or is broken</span>
00229     <span class="keywordflow">if</span> ( <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea8">state</a>() == EngineBase::Idle )
00230     {
00231         kdDebug() &lt;&lt; k_funcinfo &lt;&lt; <span class="stringliteral">"Idle detected. Skipping track.\n"</span>;
00232 
00233         <span class="keywordflow">if</span> ( <a class="code" href="classAmarokConfig.html#AmarokConfige34">AmarokConfig::trackDelayLength</a>() &gt; 0 ) <span class="comment">//this can occur syncronously to XFade and not be fatal</span>
00234         {
00235             <span class="comment">//delay before start of next track, without freezing the app</span>
00236             <a class="code" href="classEngineController.html#EngineControllerr4">m_delayTime</a> += <a class="code" href="classEngineController.html#EngineControllerv0">MAIN_TIMER</a>;
00237             <span class="keywordflow">if</span> ( <a class="code" href="classEngineController.html#EngineControllerr4">m_delayTime</a> &gt;= <a class="code" href="classAmarokConfig.html#AmarokConfige34">AmarokConfig::trackDelayLength</a>() )
00238             {
00239                 <a class="code" href="classEngineController.html#EngineControllerr4">m_delayTime</a> = 0;
00240                 <a class="code" href="classEngineController.html#EngineControlleri1">next</a>();
00241             }
00242         }
00243         <span class="keywordflow">else</span>
00244             <a class="code" href="classEngineController.html#EngineControlleri1">next</a>();
00245     }
00246     <span class="comment">// Crossfading</span>
00247     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ( <a class="code" href="classAmarokConfig.html#AmarokConfige56">AmarokConfig::crossfade</a>() ) &amp;&amp;
00248               ( <a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea13">supportsXFade</a>() ) &amp;&amp;
00249               ( !<a class="code" href="classEngineController.html#EngineControllerr0">m_pEngine</a>-&gt;<a class="code" href="classEngineBase.html#EngineBasea12">isStream</a>() ) &amp;&amp;
00250               ( length ) &amp;&amp;
00251               ( length - position &lt; (uint)<a class="code" href="classAmarokConfig.html#AmarokConfige58">AmarokConfig::crossfadeLength</a>() )  )
00252     {
00253         kdDebug() &lt;&lt; k_funcinfo &lt;&lt; <span class="stringliteral">"Crossfading to next track.\n"</span>;
00254         <a class="code" href="classEngineController.html#EngineControlleri1">next</a>();
00255     }
00256     emit <a class="code" href="classEngineController.html#EngineControllerl3">TrackPosition</a>(position/1000);
00257 }
00258 
00259 
00260 <span class="preprocessor">#include "<a class="code" href="enginecontroller_8moc.html">enginecontroller.moc</a>"</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri May 13 16:53:35 2005 for HDASS by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
